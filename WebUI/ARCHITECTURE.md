# Web UI æ¡†æ¶ä¸å·¥ä½œæµç¨‹è¯¦è§£

## ä¸€ã€æŠ€æœ¯æ ˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æµè§ˆå™¨ç«¯                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  React 18 + Vite + Tailwind CSS                      â”‚  â”‚
â”‚  â”‚  â€¢ ç»„ä»¶åŒ– UI è®¾è®¡                                     â”‚  â”‚
â”‚  â”‚  â€¢ å®æ—¶ WebSocket è¿æ¥                               â”‚  â”‚
â”‚  â”‚  â€¢ ç»ç’ƒæ€ (Glassmorphism) è®¾è®¡é£æ ¼                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ HTTP + WebSocket
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       åç«¯æœåŠ¡å™¨                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Flask + Flask-Sock                                   â”‚  â”‚
â”‚  â”‚  â€¢ REST API æœåŠ¡                                      â”‚  â”‚
â”‚  â”‚  â€¢ WebSocket å®æ—¶é€šä¿¡                                 â”‚  â”‚
â”‚  â”‚  â€¢ é™æ€æ–‡ä»¶æœåŠ¡ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  RobotService (æœåŠ¡å±‚)                                â”‚  â”‚
â”‚  â”‚  â€¢ å°è£… LLM å’Œ Robot äº¤äº’é€»è¾‘                         â”‚  â”‚
â”‚  â”‚  â€¢ ç®¡ç†ä»»åŠ¡å†å²å’ŒçŠ¶æ€                                 â”‚  â”‚
â”‚  â”‚  â€¢ å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œ                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åŸæœ‰é¡¹ç›®æ¨¡å—                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ LLM_Module   â”‚  â”‚ Robot_Module â”‚  â”‚ VLM_Module       â”‚ â”‚
â”‚  â”‚ â€¢ ä»»åŠ¡è§„åˆ’   â”‚  â”‚ â€¢ MCP å·¥å…·   â”‚  â”‚ â€¢ è§†è§‰è¯†åˆ«       â”‚ â”‚
â”‚  â”‚ â€¢ åŒå±‚ LLM   â”‚  â”‚ â€¢ ROS2 é€šä¿¡  â”‚  â”‚                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Sim_Module                                â”‚
â”‚                  2D ä»¿çœŸå™¨                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## äºŒã€å‰ç«¯æ¶æ„è¯¦è§£

### 2.1 ç›®å½•ç»“æ„

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/          # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ CommandInput.jsx    # å‘½ä»¤è¾“å…¥ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ RobotStatus.jsx     # çŠ¶æ€æ˜¾ç¤ºå¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ AvailableTools.jsx  # å·¥å…·åˆ—è¡¨å±•ç¤º
â”‚   â”‚   â””â”€â”€ TaskHistory.jsx     # ä»»åŠ¡å†å²è®°å½•
â”‚   â”‚
â”‚   â”œâ”€â”€ contexts/           # React Context (çŠ¶æ€ç®¡ç†)
â”‚   â”‚   â””â”€â”€ RobotContext.jsx    # å…¨å±€æœºå™¨äººçŠ¶æ€
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/              # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â””â”€â”€ useWebSocket.js     # WebSocket è¿æ¥ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ App.jsx             # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ main.jsx            # å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ index.css           # å…¨å±€æ ·å¼ (Tailwind)
â”‚
â”œâ”€â”€ index.html              # HTML æ¨¡æ¿
â”œâ”€â”€ package.json            # ä¾èµ–é…ç½®
â”œâ”€â”€ vite.config.js          # Vite æ„å»ºé…ç½®
â””â”€â”€ tailwind.config.js      # Tailwind ä¸»é¢˜é…ç½®
```

### 2.2 æ ¸å¿ƒç»„ä»¶è¯´æ˜

#### **CommandInput.jsx** - å‘½ä»¤è¾“å…¥ç»„ä»¶
```jsx
åŠŸèƒ½ï¼š
- å¤šè¡Œæ–‡æœ¬è¾“å…¥ï¼ˆè‡ªé€‚åº”é«˜åº¦ï¼‰
- å¿«æ·å‘½ä»¤å»ºè®®æŒ‰é’®
- è¾“å…¥éªŒè¯å’Œæäº¤
- å¤„ç†ä¸­çŠ¶æ€æ˜¾ç¤º

UIç‰¹æ€§ï¼š
- ç»ç’ƒæ€è¾“å…¥æ¡†
- å­—ç¬¦è®¡æ•°
- å¿«æ·å‘½ä»¤æ ‡ç­¾
```

#### **RobotStatus.jsx** - çŠ¶æ€æ˜¾ç¤ºå¡ç‰‡
```jsx
åŠŸèƒ½ï¼š
- æ˜¾ç¤ºæœºå™¨äººè¿æ¥çŠ¶æ€
- å®æ—¶ç»Ÿè®¡ä¿¡æ¯ï¼ˆä»»åŠ¡æ•°ã€å·¥å…·æ•°ï¼‰
- API é…ç½®çŠ¶æ€

çŠ¶æ€æŒ‡ç¤ºï¼š
- å°±ç»ª âœ… (ç»¿è‰²)
- æ‰§è¡Œä¸­ ğŸ”„ (è“è‰²)
- æœªè¿æ¥ âš ï¸ (é»„è‰²)
```

#### **TaskHistory.jsx** - ä»»åŠ¡å†å²
```jsx
åŠŸèƒ½ï¼š
- æ˜¾ç¤ºæ‰€æœ‰æ‰§è¡Œè¿‡çš„ä»»åŠ¡
- å±•ç¤ºæ¯ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ­¥éª¤
- çŠ¶æ€æ ‡è¯†ï¼ˆæˆåŠŸ/å¤±è´¥/è¿›è¡Œä¸­ï¼‰
- é”™è¯¯ä¿¡æ¯æ˜¾ç¤º

äº¤äº’ï¼š
- å¯å±•å¼€/æ”¶èµ·æ­¥éª¤è¯¦æƒ…
- æ”¯æŒæ˜¾ç¤ºå…¨éƒ¨æˆ–æœ€è¿‘Næ¡
```

#### **AvailableTools.jsx** - å·¥å…·åˆ—è¡¨
```jsx
åŠŸèƒ½ï¼š
- å±•ç¤ºæ‰€æœ‰å¯ç”¨çš„æœºå™¨äººå·¥å…·
- æŒ‰ç±»åˆ«åˆ†ç»„ï¼ˆç§»åŠ¨æ§åˆ¶ã€è§†è§‰æ„ŸçŸ¥ç­‰ï¼‰
- æ˜¾ç¤ºå·¥å…·å‚æ•°å’Œæè¿°

äº¤äº’ï¼š
- ç‚¹å‡»å·¥å…·æŸ¥çœ‹è¯¦æƒ…
- é«˜äº®é€‰ä¸­çŠ¶æ€
```

### 2.3 çŠ¶æ€ç®¡ç† (RobotContext)

```jsx
// å…¨å±€çŠ¶æ€ç»“æ„
{
  status: {           // ç³»ç»ŸçŠ¶æ€
    is_processing: false,
    total_tasks: 5,
    available_tools: 4,
    api_configured: true
  },
  tools: [],          // å¯ç”¨å·¥å…·åˆ—è¡¨
  history: [],        // ä»»åŠ¡å†å²è®°å½•
  isLoading: false,   // åŠ è½½çŠ¶æ€
  isProcessing: false // å¤„ç†çŠ¶æ€
}

// æä¾›çš„æ–¹æ³•
{
  fetchStatus(),      // è·å–ç³»ç»ŸçŠ¶æ€
  fetchTools(),       // è·å–å·¥å…·åˆ—è¡¨
  fetchHistory(),     // è·å–å†å²è®°å½•
  executeCommand(input) // æ‰§è¡Œå‘½ä»¤
}
```

### 2.4 WebSocket Hook

```javascript
useWebSocket(url)
// åŠŸèƒ½ï¼š
// - è‡ªåŠ¨è¿æ¥å’Œé‡è¿ï¼ˆæœ€å¤š5æ¬¡ï¼‰
// - å¿ƒè·³æ£€æµ‹ï¼ˆ30ç§’é—´éš”ï¼‰
// - æ¶ˆæ¯è§£æå’Œåˆ†å‘
// - è¿æ¥çŠ¶æ€ç®¡ç†

// æ¶ˆæ¯ç±»å‹ï¼š
{
  type: 'progress',   // ä»»åŠ¡æ‰§è¡Œè¿›åº¦
  type: 'complete',   // ä»»åŠ¡å®Œæˆé€šçŸ¥
  type: 'status',     // çŠ¶æ€æ›´æ–°
  type: 'ping'/'pong' // å¿ƒè·³
}
```

## ä¸‰ã€åç«¯æ¶æ„è¯¦è§£

### 3.1 Flask è·¯ç”±ç»“æ„

```python
@app.route('/')                 # GET  â†’ å‰ç«¯é¡µé¢
@app.route('/api/status')       # GET  â†’ ç³»ç»ŸçŠ¶æ€
@app.route('/api/tools')        # GET  â†’ å·¥å…·åˆ—è¡¨
@app.route('/api/history')      # GET  â†’ ä»»åŠ¡å†å²
@app.route('/api/command')      # POST â†’ æ‰§è¡Œå‘½ä»¤
@sock.route('/ws')             # WebSocket â†’ å®æ—¶é€šä¿¡
```

### 3.2 API æ¥å£è¯¦è§£

#### **GET /api/status**
è·å–ç³»ç»ŸçŠ¶æ€

**å“åº”ï¼š**
```json
{
  "is_processing": false,
  "total_tasks": 5,
  "api_configured": true,
  "available_tools": 4
}
```

#### **GET /api/tools**
è·å–å¯ç”¨å·¥å…·åˆ—è¡¨

**å“åº”ï¼š**
```json
[
  {
    "name": "move_forward",
    "description": "æ§åˆ¶æœºå™¨äººå‘å‰ç§»åŠ¨",
    "parameters": ["distance", "speed"]
  }
]
```

#### **GET /api/history**
è·å–ä»»åŠ¡å†å²

**å“åº”ï¼š**
```json
[
  {
    "id": "task_1",
    "input": "å‘å‰ç§»åŠ¨ 1 ç±³",
    "status": "completed",
    "timestamp": "2025-01-22 10:30:00",
    "steps": [...],
    "summary": "1/1 ä¸ªä»»åŠ¡æˆåŠŸ"
  }
]
```

#### **POST /api/command**
æ‰§è¡Œç”¨æˆ·å‘½ä»¤

**è¯·æ±‚ï¼š**
```json
{
  "input": "å‘å‰ç§»åŠ¨ 1 ç±³"
}
```

**å“åº”ï¼š**
```json
{
  "success": true,
  "message": "å‘½ä»¤å·²æ¥å—"
}
```

#### **WebSocket /ws**
å®æ—¶é€šä¿¡

**æ¶ˆæ¯æ ¼å¼ï¼š**
```json
{
  "type": "progress" | "complete" | "status" | "ping",
  "data": { ... }
}
```

### 3.3 RobotService æœåŠ¡å±‚

```python
class RobotService:
    """å•ä¾‹æœåŠ¡ç±»ï¼Œç®¡ç†æ•´ä¸ªæœºå™¨äººäº¤äº’é€»è¾‘"""

    def __init__(self):
        # 1. æ³¨å†Œ MCP å·¥å…·
        register_all_modules()

        # 2. è·å–å·¥å…·å®šä¹‰
        self.tools = get_tool_definitions()

        # 3. åˆå§‹åŒ– LLM Agent
        self.llm_agent = LLMAgent(...)

        # 4. åŠ¨æ€åŠ è½½æç¤ºè¯
        self._load_dynamic_prompt(...)

    async def process_command(user_input, callback):
        """å¤„ç†ç”¨æˆ·å‘½ä»¤çš„æ ¸å¿ƒæ–¹æ³•"""
        # 1. æ‰§è¡ŒåŒå±‚ LLM æµç¨‹
        results = await self.llm_agent.run_pipeline(...)

        # 2. é€šè¿‡å›è°ƒå‘é€è¿›åº¦
        callback({"type": "progress", ...})

        # 3. è®°å½•ä»»åŠ¡å†å²
        self.task_history.append(...)
```

## å››ã€å®Œæ•´å·¥ä½œæµç¨‹

### åœºæ™¯ï¼šç”¨æˆ·å‘é€"å‘å‰ç§»åŠ¨ 1 ç±³"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç”¨æˆ·åœ¨ Web UI è¾“å…¥å‘½ä»¤                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. React ç»„ä»¶ (CommandInput)                                 â”‚
â”‚    - handleSubmit() è¢«è§¦å‘                                   â”‚
â”‚    - è°ƒç”¨ RobotContext.executeCommand("å‘å‰ç§»åŠ¨ 1 ç±³")       â”‚
â”‚    - å‘é€ POST è¯·æ±‚åˆ° /api/command                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ HTTP POST
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Flask åç«¯ (app.py)                                       â”‚
â”‚    - æ¥æ”¶è¯·æ±‚                                                 â”‚
â”‚    - åˆ›å»ºåå°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼ˆé¿å…é˜»å¡ï¼‰                         â”‚
â”‚    - è¿”å› 202 Accepted                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. RobotService.process_command()                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ 4.1 ä¸Šå±‚ LLM (è§„åˆ’å±‚)                                 â”‚  â”‚
â”‚    â”‚     è¾“å…¥: "å‘å‰ç§»åŠ¨ 1 ç±³"                             â”‚  â”‚
â”‚    â”‚     è¾“å‡º: [                                          â”‚  â”‚
â”‚    â”‚       {                                             â”‚  â”‚
â”‚    â”‚         "tool": "move_forward",                     â”‚  â”‚
â”‚    â”‚         "arguments": {"distance": 1.0, "speed": 0.3}â”‚  â”‚
â”‚    â”‚       }                                             â”‚  â”‚
â”‚    â”‚     ]                                               â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                   â”‚
â”‚                           â–¼                                   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ 4.2 ä¸‹å±‚ LLM (æ‰§è¡Œå±‚)                                 â”‚  â”‚
â”‚    â”‚     - ä½¿ç”¨ OpenAI function-calling                   â”‚  â”‚
â”‚    â”‚     - è°ƒç”¨ execute_tool("move_forward", {...})       â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                   â”‚
â”‚                           â–¼                                   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ 4.3 æ‰§è¡Œå·¥å…·å‡½æ•°                                     â”‚  â”‚
â”‚    â”‚     - è°ƒç”¨ Robot_Module ä¸­çš„ MCP å·¥å…·               â”‚  â”‚
â”‚    â”‚     - å‘é€å‘½ä»¤åˆ° ROS2 è¯é¢˜                           â”‚  â”‚
â”‚    â”‚     - WebSocket å¹¿æ’­è¿›åº¦                             â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Robot_Module (MCP å·¥å…·)                                   â”‚
â”‚    - move_forward(distance=1.0, speed=0.3)                   â”‚
â”‚    - å‘é€åˆ° ROS2 è¯é¢˜: /robot/command                        â”‚
â”‚    - æ¶ˆæ¯: {"action": "move_forward", "parameters": {...}}   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ ROS2 Topic
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Sim_Module (2D ä»¿çœŸå™¨)                                    â”‚
â”‚    - è®¢é˜… /robot/command è¯é¢˜                                â”‚
â”‚    - æ‰§è¡Œç§»åŠ¨åŠ¨ç”»                                             â”‚
â”‚    - æ›´æ–°æœºå™¨äººä½ç½®                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                 â–²
                 â”‚ WebSocket å®æ—¶æ¨é€
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. å‰ç«¯å®æ—¶æ›´æ–°                                               â”‚
â”‚    - WebSocket æ¥æ”¶è¿›åº¦æ¶ˆæ¯                                   â”‚
â”‚    - æ›´æ–° UI çŠ¶æ€                                            â”‚
â”‚    - æ˜¾ç¤ºæ‰§è¡Œæ­¥éª¤                                            â”‚
â”‚    - ä»»åŠ¡å®Œæˆååˆ·æ–°å†å²è®°å½•                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## äº”ã€æ•°æ®æµå›¾

```
ç”¨æˆ·è¾“å…¥
   â”‚
   â”œâ”€â”€â”€ HTTP POST â”€â”€â†’ Flask Backend
   â”‚                        â”‚
   â”‚                        â”œâ”€â”€â”€ RobotService
   â”‚                        â”‚        â”‚
   â”‚                        â”‚        â”œâ”€â”€â”€ LLM_Module (è§„åˆ’)
   â”‚                        â”‚        â”‚        â”‚
   â”‚                        â”‚        â”‚        â””â”€â”€â”€ function-calling
   â”‚                        â”‚        â”‚                 â”‚
   â”‚                        â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â†’ Robot_Module (MCP)
   â”‚                        â”‚                          â”‚
   â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ROS2 Topic
   â”‚                                              â”‚
   â””â”€â”€ WebSocket â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â””â”€â”€â†’ React UI å®æ—¶æ›´æ–°
```

## å…­ã€å…³é”®æŠ€æœ¯ç‰¹ç‚¹

### 1. **åŒå±‚ LLM æ¶æ„**
```
ä¸Šå±‚ï¼ˆè§„åˆ’ï¼‰â†’ åˆ†è§£å¤æ‚ä»»åŠ¡
ä¸‹å±‚ï¼ˆæ‰§è¡Œï¼‰â†’ é€šè¿‡ function calling è°ƒç”¨å·¥å…·
```

**ä¼˜åŠ¿ï¼š**
- ä»»åŠ¡è§„åˆ’ä¸æ‰§è¡Œåˆ†ç¦»
- æ›´å¥½çš„å¯æ‰©å±•æ€§
- æ”¯æŒå¤æ‚çš„å¤šæ­¥éª¤ä»»åŠ¡

### 2. **WebSocket å®æ—¶é€šä¿¡**
```javascript
// è‡ªåŠ¨é‡è¿æœºåˆ¶
- æŒ‡æ•°é€€é¿é‡è¿ï¼ˆ1s, 2s, 4s, ... æœ€å¤§30sï¼‰
- æœ€å¤š5æ¬¡é‡è¿å°è¯•
- 30ç§’å¿ƒè·³ä¿æ´»
```

**æ¶ˆæ¯ç±»å‹ï¼š**
- `progress` - ä»»åŠ¡æ‰§è¡Œè¿›åº¦æ›´æ–°
- `complete` - ä»»åŠ¡å®Œæˆé€šçŸ¥
- `status` - ç³»ç»ŸçŠ¶æ€æ›´æ–°
- `ping`/`pong` - å¿ƒè·³æ£€æµ‹

### 3. **å¼‚æ­¥ä»»åŠ¡å¤„ç†**
```python
# Flask åç«¯ä¸é˜»å¡ä¸»çº¿ç¨‹
def run_command():
    # åœ¨åå°çº¿ç¨‹æ‰§è¡Œ
    result = asyncio.run(robot_service.process_command(...))

threading.Thread(target=run_command, daemon=True).start()
```

**ä¼˜åŠ¿ï¼š**
- ä¸é˜»å¡å…¶ä»–è¯·æ±‚
- æ”¯æŒé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡
- é€šè¿‡ WebSocket æ¨é€è¿›åº¦

### 4. **ç»ç’ƒæ€è®¾è®¡é£æ ¼**
```css
.glass-card {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(16px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.37);
}
```

**ç‰¹ç‚¹ï¼š**
- ç°ä»£åŒ–çš„è§†è§‰é£æ ¼
- åŠé€æ˜èƒŒæ™¯ + èƒŒæ™¯æ¨¡ç³Š
- æµç•…çš„åŠ¨ç”»æ•ˆæœ

### 5. **React Context çŠ¶æ€ç®¡ç†**
```javascript
// å…¨å±€çŠ¶æ€å…±äº«
<RobotProvider>
  <App />
</RobotProvider>

// ä»»æ„ç»„ä»¶è®¿é—®
const { status, executeCommand } = useRobot();
```

## ä¸ƒã€å¯åŠ¨æµç¨‹

```bash
ç”¨æˆ·è¿è¡Œ start_webui.bat
        â”‚
        â”œâ”€â”€â”€ 1. æ£€æŸ¥ .env æ–‡ä»¶
        â”‚
        â”œâ”€â”€â”€ 2. å®‰è£…åç«¯ä¾èµ–
        â”‚
        â”œâ”€â”€â”€ 3. å®‰è£…å‰ç«¯ä¾èµ–
        â”‚
        â”œâ”€â”€â”€ 4. æ„å»ºå‰ç«¯
        â”‚     npm run build â†’ dist/
        â”‚
        â””â”€â”€â”€ 5. å¯åŠ¨ Flask æœåŠ¡å™¨
              â”‚
              â”œâ”€â”€â”€ æä¾›é™æ€æ–‡ä»¶ (dist/)
              â”œâ”€â”€â”€ REST API æœåŠ¡
              â””â”€â”€ WebSocket æœåŠ¡

æµè§ˆå™¨è®¿é—® http://localhost:5000
        â”‚
        â””â”€â”€â”€ åŠ è½½å•é¡µåº”ç”¨ (SPA)
              â”‚
              â””â”€â”€â”€ React æ¸²æŸ“ UI
```

## å…«ã€å¼€å‘æ¨¡å¼ vs ç”Ÿäº§æ¨¡å¼

### å¼€å‘æ¨¡å¼
```bash
# ç»ˆç«¯1: åç«¯
cd backend
python app.py

# ç»ˆç«¯2: å‰ç«¯ï¼ˆå¸¦çƒ­æ›´æ–°ï¼‰
cd frontend
npm run dev

# è®¿é—®: http://localhost:5173
```

**ç‰¹ç‚¹ï¼š**
- å‰ç«¯æ”¯æŒçƒ­æ›´æ–°ï¼ˆHMRï¼‰
- Vite å¼€å‘æœåŠ¡å™¨
- è‡ªåŠ¨ä»£ç† API è¯·æ±‚åˆ°åç«¯

### ç”Ÿäº§æ¨¡å¼
```bash
# ä¸€é”®å¯åŠ¨
start_webui.bat

# æˆ–æ‰‹åŠ¨æ„å»º
cd frontend
npm run build

cd ../backend
python app.py

# è®¿é—®: http://localhost:5000
```

**ç‰¹ç‚¹ï¼š**
- å‰ç«¯ä»£ç æ‰“åŒ…ä¼˜åŒ–
- Flask æä¾›é™æ€æ–‡ä»¶
- å•ä¸€ç«¯å£è®¿é—®
- é€‚åˆéƒ¨ç½²

## ä¹ã€æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°ç»„ä»¶

1. åœ¨ `frontend/src/components/` åˆ›å»ºæ–°ç»„ä»¶
2. åœ¨ `App.jsx` ä¸­å¼•å…¥å¹¶ä½¿ç”¨
3. ä½¿ç”¨ Tailwind CSS ç¼–å†™æ ·å¼

```jsx
// ç¤ºä¾‹ï¼šæ–°å»ºç»„ä»¶
// frontend/src/components/NewFeature.jsx
import React from 'react'

export default function NewFeature() {
  return (
    <div className="glass-card p-6">
      {/* ä½ çš„ç»„ä»¶å†…å®¹ */}
    </div>
  )
}
```

### æ·»åŠ æ–° API ç«¯ç‚¹

1. åœ¨ `backend/app.py` æ·»åŠ æ–°è·¯ç”±
2. åœ¨ `frontend/src/contexts/RobotContext.jsx` æ·»åŠ è°ƒç”¨æ–¹æ³•
3. æ›´æ–°ç»„ä»¶ä»¥ä½¿ç”¨æ–°çš„ API

```python
# ç¤ºä¾‹ï¼šæ·»åŠ æ–°ç«¯ç‚¹
@app.route('/api/custom', methods=['POST'])
def custom_endpoint():
    data = request.get_json()
    # å¤„ç†é€»è¾‘
    return jsonify({"result": "success"})
```

### è‡ªå®šä¹‰æ ·å¼

- ä¿®æ”¹ `frontend/src/index.css` ä¸­çš„å…¨å±€æ ·å¼
- ä¿®æ”¹ `frontend/tailwind.config.js` ä¸­çš„ä¸»é¢˜é…ç½®
- ä½¿ç”¨ Tailwind çš„ utility classes è¿›è¡Œæ ·å¼å®šåˆ¶

```javascript
// tailwind.config.js
export default {
  theme: {
    extend: {
      colors: {
        // æ·»åŠ è‡ªå®šä¹‰é¢œè‰²
        custom: '#your-color',
      },
      animation: {
        // æ·»åŠ è‡ªå®šä¹‰åŠ¨ç”»
        'custom-animation': 'animation-name 1s ease-in-out',
      },
    },
  },
}
```

## åã€æ•…éšœæ’æŸ¥

### åç«¯æ— æ³•å¯åŠ¨
- æ£€æŸ¥ `Test_API_KEY` æ˜¯å¦å·²è®¾ç½®
- ç¡®ä¿æ‰€æœ‰ Python ä¾èµ–å·²å®‰è£…
- æ£€æŸ¥ç«¯å£ 5000 æ˜¯å¦è¢«å ç”¨

### å‰ç«¯æ— æ³•è¿æ¥åç«¯
- ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥ CORS é…ç½®
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### WebSocket è¿æ¥å¤±è´¥
- ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ WebSocket åœ°å€
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- ç¡®è®¤åç«¯ WebSocket æœåŠ¡æ­£å¸¸

### ä»¿çœŸå™¨ä¸å“åº”
- ç¡®ä¿ä»¿çœŸå™¨æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥ ROS2 è¯é¢˜è¿æ¥
- éªŒè¯ ROS2 ç¯å¢ƒé…ç½®

---

## æ€»ç»“

è¿™ä¸ª Web UI æ¡†æ¶é‡‡ç”¨ç°ä»£åŒ–çš„å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œé€šè¿‡ REST API å’Œ WebSocket å®ç°é€šä¿¡ï¼Œä¿æŒäº†è‰¯å¥½çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚æ•´ä½“è®¾è®¡éµå¾ª React æœ€ä½³å®è·µï¼Œä½¿ç”¨ Tailwind CSS å®ç°ç²¾ç¾çš„ç»ç’ƒæ€è®¾è®¡é£æ ¼ï¼Œä¸ºç”¨æˆ·æä¾›æµç•…çš„äº¤äº’ä½“éªŒã€‚
